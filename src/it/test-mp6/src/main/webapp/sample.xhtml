<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:f="jakarta.faces.core"
                xmlns:h="jakarta.faces.html"
                template="/WEB-INF/layout/template.xhtml">

    <ui:define name="content">
        <h3>Sample</h3>
        <p>Represents samples collected for testing.</p>
        <h:panelGrid columns="2" columnClasses="label,value" styleClass="table-form">

            <h:outputLabel for="type" value="Type:" />
            <h:inputText id="type" value="#{sampleBean.sample.type}" />

            <h:outputLabel for="collectionDate" value="Collection Date:" />
            <h:inputText id="collectionDate" 
                         value="#{sampleBean.sample.collectionDate}" 
                         converter="localDateConverter">
                <f:passThroughAttribute name="type" value="date" />
            </h:inputText>

            <h:outputLabel for="patient" value="Patient:" />
            <h:selectOneMenu id="patient"
                             value="#{sampleBean.sample.patient}"
                             converter="patientConverter">
                <f:selectItem itemLabel="Select Patient" noSelectionOption="true" />
                <f:selectItems value="#{patientBean.allPatients}"
                               var="patient"
                               itemValue="#{patient}"
                               itemLabel="#{patient}" />
            </h:selectOneMenu>

            <h:outputLabel for="manager" value="Manager:" />
            <h:selectOneMenu id="manager"
                             value="#{sampleBean.sample.manager}"
                             converter="labManagerConverter">
                <f:selectItem itemLabel="Select Manager" noSelectionOption="true" />
                <f:selectItems value="#{labManagerBean.allLabManagers}"
                               var="manager"
                               itemValue="#{manager}"
                               itemLabel="#{manager}" />
            </h:selectOneMenu>

            <h:outputLabel for="collector" value="Collector:" />
            <h:selectOneMenu id="collector"
                             value="#{sampleBean.sample.collector}"
                             converter="labTechnicianConverter">
                <f:selectItem itemLabel="Select Collector" noSelectionOption="true" />
                <f:selectItems value="#{labTechnicianBean.allLabTechnicians}"
                               var="collector"
                               itemValue="#{collector}"
                               itemLabel="#{collector}" />
            </h:selectOneMenu>
        </h:panelGrid>
        <h:inputHidden id="sampleId" 
                       value="#{sampleBean.sample.sampleId}" />

        <h:commandButton value="Save" action="#{sampleBean.save}" styleClass="btn btn-primary mt-3" />

        <h3 class="mt-5">Sample List</h3>
        <h:dataTable value="#{sampleBean.allSamples}" var="sample" border="1" styleClass="table table-striped table-bordered">
            <h:column>
                <f:facet name="header">Sample Id</f:facet>
                #{sample.sampleId}
            </h:column>
            <h:column>
                <f:facet name="header">Type</f:facet>
                #{sample.type}
            </h:column>
            <h:column>
                <f:facet name="header">Collection Date</f:facet>
                #{sample.collectionDate}
            </h:column>
            <h:column>
                <f:facet name="header">Patient</f:facet>
                #{sample.patient}
            </h:column>
            <h:column>
                <f:facet name="header">Manager</f:facet>
                #{sample.manager}
            </h:column>
            <h:column>
                <f:facet name="header">Collector</f:facet>
                #{sample.collector}
            </h:column>
            <h:column>
                <f:facet name="header">Actions</f:facet>
                <h:commandLink value="Edit" action="#{sampleBean.edit(sample)}" styleClass="btn btn-link p-0" />
                |
                <h:commandLink value="Delete" action="#{sampleBean.remove(sample.sampleId)}"
                               onclick="return confirm('Delete this sample?');" 
                               styleClass="btn btn-link p-0 text-danger" />
            </h:column>
        </h:dataTable>
    </ui:define>
</ui:composition>
